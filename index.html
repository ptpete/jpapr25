<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Checkbox Sync</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
</head>
<body>
    <h1>Firebase Checkbox Sync3333</h1>
    <button id="addCheckboxBtn">Add New Checkbox</button>
    <ul id="checkboxList"></ul>

    <script type="module">
        // Import necessary Firebase functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
        import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js";

        // Your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyCAbCD5eLXKW-izbCmVOpA-9jAjcLSN3b4",
            authDomain: "jpapr25.firebaseapp.com",
            projectId: "jpapr25",
            storageBucket: "jpapr25.firebasestorage.app",
            messagingSenderId: "664046829915",
            appId: "1:664046829915:web:7d16ace7d82bf918295a7e"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Add a new checkbox
        const addCheckbox = () => {
            const checkboxesRef = ref(db, 'checkboxes');
            const newCheckboxRef = push(checkboxesRef); // Create a new unique node
            set(newCheckboxRef, {
                checked: false  // Initial value for the checkbox
            });
        };

        // Load all checkboxes
        const loadCheckboxes = () => {
            const checkboxList = document.getElementById('checkboxList');
            const checkboxesRef = ref(db, 'checkboxes');
            
            onValue(checkboxesRef, (snapshot) => {
                checkboxList.innerHTML = ''; // Clear the list before adding items
                snapshot.forEach(childSnapshot => {
                    const checkboxData = childSnapshot.val();
                    const checkboxItem = document.createElement('li');
                    checkboxItem.innerHTML = `
                        <input type="checkbox" data-id="${childSnapshot.key}" ${checkboxData.checked ? 'checked' : ''}>
                        Checkbox ${childSnapshot.key}
                    `;
                    checkboxList.appendChild(checkboxItem);

                    // Event listener to update checkbox status in the database
                    checkboxItem.querySelector('input').addEventListener('change', (e) => {
                        const checkboxId = e.target.getAttribute('data-id');
                        const checkboxChecked = e.target.checked;
                        const checkboxRef = ref(db, 'checkboxes/' + checkboxId);
                        set(checkboxRef, { checked: checkboxChecked });
                    });
                });
            });
        };

        // Event listener for adding new checkbox
        document.getElementById('addCheckboxBtn').addEventListener('click', addCheckbox);

        // Load checkboxes when the page loads
        window.onload = loadCheckboxes;
    </script>
</body>
</html>
