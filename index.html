<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sync Checkbox with Google Sheets</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <h1>Sync Checkbox with Google Sheets999</h1>

    <!-- Checkbox to control state -->
    <label for="checkbox1">Checkbox 1</label>
    <input type="checkbox" id="checkbox1">

    <button id="syncButton">Sync Now</button>

    <p id="status">Status: Waiting for sync...</p>

    <script>
        // Your Google Sheets API Key and Sheet ID
        const API_KEY = 'AIzaSyCNxV6lXO282697QMTfh50Cmrl0OSKLW9Q';
        const SHEET_ID = '1Drhe2Hh4e_Vmw8XMa8e7Oyh-4bOB178BoBYRF06n0Gk'; // Replace with your Google Sheet ID

        // Function to initialize the Google API client
        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"]
            }).then(function() {
                console.log("Google API client initialized.");
            });
        }

        // Load the Google API client
        gapi.load("client", initClient);

        // Function to handle checkbox change and send it to Google Sheets
        async function handleCheckboxChange(isChecked) {
            const range = 'Sheet1!B2'; // Update this according to your sheet and cell
            const body = {
                values: [[isChecked ? 'TRUE' : 'FALSE']] // Use TRUE/FALSE based on checkbox state
            };

            const response = await fetch(
                `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${range}?valueInputOption=RAW&key=${API_KEY}`,
                {
                    method: 'PUT',
                    body: JSON.stringify(body),
                    headers: { 'Content-Type': 'application/json' }
                }
            );

            const result = await response.json();

            if (response.ok) {
                console.log('Successfully updated Google Sheets:', result);
                document.getElementById('status').innerText = 'Status: Successfully synced!';
            } else {
                console.error('Error updating Google Sheets:', result);
                document.getElementById('status').innerText = 'Status: Sync failed!';
            }
        }

        // Attach event listener to the checkbox for real-time updates
        document.getElementById('checkbox1').addEventListener('change', function(event) {
            handleCheckboxChange(event.target.checked);
        });

        // Attach event listener to the sync button to manually sync checkbox state
        document.getElementById('syncButton').addEventListener('click', function() {
            const isChecked = document.getElementById('checkbox1').checked;
            handleCheckboxChange(isChecked);
        });
    </script>
</body>
</html>
