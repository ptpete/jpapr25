<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Checkbox Sync</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
</head>
<body>
    <h1>Checkbox Sync</h1>
    <button id="addCheckboxBtn">Add New Checkbox</button>
    <ul id="checkboxList"></ul>

    <script type="module">
        // Import the functions you need from Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js";

        // Firebase configuration object
        const firebaseConfig = {
            apiKey: "AIzaSyCAbCD5eLXKW-izbCmVOpA-9jAjcLSN3b4",
            authDomain: "jpapr25.firebaseapp.com",
            projectId: "jpapr25",
            storageBucket: "jpapr25.firebasestorage.app",
            messagingSenderId: "664046829915",
            appId: "1:664046829915:web:7d16ace7d82bf918295a7e"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Function to update checkbox in the database
        const addCheckbox = () => {
            const checkboxRef = ref(db, 'checkboxes');
            const newCheckboxRef = checkboxRef.push();
            set(newCheckboxRef, {
                checked: false
            });
        };

        // Function to load checkboxes from the database
        const loadCheckboxes = () => {
            const checkboxList = document.getElementById('checkboxList');
            const checkboxRef = ref(db, 'checkboxes');

            onValue(checkboxRef, (snapshot) => {
                checkboxList.innerHTML = ''; // Clear current checkboxes
                snapshot.forEach(childSnapshot => {
                    const checkboxData = childSnapshot.val();
                    const checkboxItem = document.createElement('li');
                    checkboxItem.innerHTML = `
                        <input type="checkbox" data-id="${childSnapshot.key}" ${checkboxData.checked ? 'checked' : ''}>
                        Checkbox ${childSnapshot.key}
                    `;
                    checkboxList.appendChild(checkboxItem);

                    // Attach event listener to update checkbox status
                    checkboxItem.querySelector('input').addEventListener('change', (e) => {
                        const checkboxId = e.target.getAttribute('data-id');
                        const checkboxChecked = e.target.checked;
                        const checkboxRef = ref(db, 'checkboxes/' + checkboxId);
                        set(checkboxRef, { checked: checkboxChecked });
                    });
                });
            });
        };

        // Add event listener to add checkbox button
        document.getElementById('addCheckboxBtn').addEventListener('click', addCheckbox);

        // Load checkboxes when the page loads
        window.onload = loadCheckboxes;
    </script>
</body>
</html>
